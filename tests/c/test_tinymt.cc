//- Copyright 2014 the Neutrino authors (see AUTHORS).
//- Licensed under the Apache License, Version 2.0 (see LICENSE).

#include "test/unittest.hh"

BEGIN_C_INCLUDES
#include "utils/tinymt.h"
END_C_INCLUDES

TEST(tinymt, examples) {
  tinymt64_params_t params;
  params.transition_matrix_1 = 0xfa051f40;
  params.transition_matrix_2 = 0xffd0fff4;
  params.tempering_matrix = 0x58d02ffeffbfffbc;
  tinymt64_t mt0 = new_tinymt64(params, 1);
  uint64_t o0[30] = {
      15503804787016557143ULL, 17280942441431881838ULL, 2177846447079362065ULL,
      10087979609567186558ULL, 8925138365609588954ULL,  13030236470185662861ULL,
      4821755207395923002ULL,  11414418928600017220ULL, 18168456707151075513ULL,
      1749899882787913913ULL,  2383809859898491614ULL,  4819668342796295952ULL,
      11996915412652201592ULL, 11312565842793520524ULL, 995000466268691999ULL,
      6363016470553061398ULL,  7460106683467501926ULL,  981478760989475592ULL,
      11852898451934348777ULL, 5976355772385089998ULL,  16662491692959689977ULL,
      4997134580858653476ULL,  11142084553658001518ULL, 12405136656253403414ULL,
      10700258834832712655ULL, 13440132573874649640ULL, 15190104899818839732ULL,
      14179849157427519166ULL, 10328306841423370385ULL, 9266343271776906817ULL
  };
  for (size_t i = 0; i < 30; i++)
    ASSERT_EQ(o0[i], tinymt64_next_uint64(&mt0, &mt0.state));
}
